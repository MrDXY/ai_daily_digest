{
  "url": "https://age-verifier.kibty.town/",
  "summary": {
    "summary": "该内容介绍了一个针对使用 k-id 作为年龄验证提供商的平台（如 Discord/Twitch/Snapchat）的“年龄验证绕过”方案：通过在 Discord 控制台注入脚本触发验证流程，并将验证 webview 重定向到第三方页面完成“成功”状态。作者进一步解释其原理：k-id/其人脸合作方主要上传人脸推理的元数据与加密载荷，而非原始人脸视频/图像，因此可通过伪造看似合理的加密字段与预测数组来通过校验。文章还披露了其逆向与对抗过程，包括 AES-GCM/HKDF 参数补齐、预测数据（raws/outputs/primaryOutputs）生成逻辑与若干一致性检查点。",
    "core_value": "从安全研究角度揭示了第三方年龄验证系统在“仅依赖客户端/元数据与可伪造一致性校验”时的潜在脆弱面，并给出较完整的绕过链路与校验点分析。对平台方与验证供应商而言，核心价值在于暴露风控/加密封装/模型输出校验的设计缺陷与加固方向。",
    "tech_stack": [
      "JavaScript",
      "Browser DevTools/Console",
      "Webpack 模块注入/模块缓存访问",
      "HTTP API 调用",
      "AES-GCM",
      "HKDF(SHA-256)",
      "Captcha 流程",
      "人脸年龄估计/推理元数据",
      "统计处理(Z-score)"
    ],
    "recommendation": "值得关注其对“隐私友好但可伪造的元数据验证”这一安全权衡的剖析，以及对加密载荷与模型输出一致性校验的逆向思路，可为身份/年龄验证系统的威胁建模与加固提供参考。但内容包含明确的绕过指引与脚本细节，阅读与传播需谨慎并以防御视角使用。",
    "score": 78.0,
    "_source_item": {
      "title": "Discord/Twitch/Snapchat age verification bypass",
      "content": "age verifies your account automatically as an adult on any website using k-id\nmade by\nxyzeva\nand\nDziurwa\n, greetz to\namplitudes\n(for previous work)\nhow to verify on discord\nit\ndoesn't matter\nif you are in the UK or similar region that\ncurrently has access to this, this will verify your account for the future global rollout in\nmarch aswell as current. to use, simply paste this script into your discord console by going to\ndiscord.com/app\n, pressing\nF12\n, going to\nConsole\nand copying and pasting and hitting enter on the following script and solving the captcha that pops\nup\n(typing \"allow pasting\" before if necessary)\n:\n// add a chunk to extract webpack's moduleCache\nlet webpackRequire = webpackChunkdiscord_app.push([[Symbol()],{},(r) => r]);\n// cleanup the chunk we added\nwebpackChunkdiscord_app.pop();\n\nlet modules = webpackRequire.m;\nlet cache = webpackRequire.c;\n\n// https://github.com/moonlight-mod/moonlight/blob/main/packages/core-extensions/src/spacepack/webpackModules/spacepack.ts\n// helper to find a webpack module via code snippet\nfunction findByCode(src) {\nfor (const [id, mod] of Object.entries(modules)) {\nif (mod.toString().includes(src)) {\nreturn cache[id].exports;\n}\n}\n}\n\n// helper to find an object by its key\nfunction findObjectFromKey(exports, key) {\nif (!exports) return;\nfor (const exportKey in exports) {\nconst obj = exports[exportKey];\nif (obj && obj[key]) return obj;\n}\n}\n\n// https://github.com/moonlight-mod/moonlight/blob/main/packages/mappings/src/mappings/discord/utils/HTTPUtils.ts\n// find the discord api client\nconst api = findObjectFromKey(\nfindByCode('.set(\"X-Audit-Log-Reason\",'),\n\"patch\",\n);\n\n// send a api request to discord /age-verification/verify and then redirect the page to our website\nconst request = await api.post({\nurl: \"/age-verification/verify\",\nbody: { method: 3 },\n});\nconst verificationUrl = request.body.verification_webview_url;\nwindow.location.href = `https://age-verifier.kibty.town/webview?url=${encodeURIComponent(verificationUrl)}`;\n(feel free to read the code, we made it readable and we have nothing to hide)\nit should navigate to a link\n(or give you a link to navigate to)\n, from there, you can just wait until the page says success\ncongrats! your discord account is now age verified.\nhow to verify on other platforms (twitch, kick, snapchat, ...others)\nnavigate to the age verification page and choose selfie, from there, get the url of the qr code\nand put it in this input box, and press verify\nverify\nhow does this work\nk-id, the age verification provider discord uses doesn't store or send your face to the server.\ninstead, it sends a bunch of metadata about your face and general process details. while this is\ngood for your privacy\n(well, considering some other providers send actual videos of your face to their servers)\n, its also bad for them, because we can just send legitimate looking metadata to their servers\nand they have no way to tell its not legitimate.\nwhile this was easy in the past, k-id's partner for face verification (faceassure) has made this significantly\nharder to achieve after\namplitudes k-id verifier\nwas released,\n(which doesn't work anymore because of it.)\nwith discord's decision of making the age verification requirement global, we decided to look into\nit again to see if we can bypass the new checks.\nstep 1: encrypted_payload and auth_tag\nthe first thing we noticed that the old implementation doesn't send when comparing a legitimate\nrequest payload with a generated one, is its missing\nencrypted_payload\n,\nauth_tag\n,\ntimestamp\nand\niv\nin the body.\nlooking at the code, this appears to be a simple AES-GCM cipher with the key being\nnonce\n+\ntimestamp\n+\ntransaction_id\n, derived using HKDF (sha256). we can easily replicate this and also create the missing\nparameters in our generated output.\nstep 2: prediction data\nheres where it kind of gets tricky, even after perfectly replicating the encryption, our\nverification attempt still doesn't succeed, so they must also be doing checks on the actual\npayload.\nafter some trial and error, we narrowed the checked part to the prediction arrays, which are\noutputs\n,\nprimaryOutputs\nand\nraws\n.\nturns out, both\noutputs\nand\nprimaryOutputs\nare generated from\nraws\n. basically, the raw\nnumbers are mapped to age outputs, and then the outliers get removed with z-score (once for\nprimaryOutputs\nand twice for\noutputs\n).\nthere is also some other differences:\nxScaledShiftAmt\nand\nyScaledShiftAmt\nin predictions are not random but\nrather can be one of two values\nit is checked that the media name (camera) matches one of your media devices in the array of\ndevices\nit is checked if the states completion times match the state timeline\nwith all of that done,  all of this\ncode is open source and available , so you can actually see how we do this exactly.",
      "description": "",
      "url": "https://age-verifier.kibty.town/",
      "source": "Hacker News"
    }
  },
  "cached_at": "2026-02-12T05:02:59.244683"
}