# ============================================
# AI 内容脱水日报 - 主配置文件
# ============================================

# 应用基础配置
app:
  name: "AI Daily Digest"
  version: "2.0.0"
  output_dir: "./output"
  log_level: "INFO"

# 爬虫配置 (StealthFetcher)
crawler:
  # 并发数
  concurrency: 5
  # 请求超时 (秒)
  timeout: 30
  # 重试次数
  max_retries: 3
  # 重试间隔 (秒)
  retry_delay: 2
  # 目录页爬取深度
  list_depth: 1
  # 页面缓存配置
  cache:
    enabled: true
    cache_dir: "./output/cache"
    keep_days: 7
  # User-Agent 池 (可选，默认使用内置池)
  user_agents: []
  # Playwright 配置
  playwright:
    headless: true
  # Crawl4AI 配置
  crawl4ai:
    headless: true

# AI 模型配置 (支持多种后端)
ai:
  # 当前使用的模型 provider
  default_provider: "azure_openai"

  # Claude 配置
  claude:
    api_key: "${ANTHROPIC_API_KEY}"
    model: "claude-sonnet-4-20250514"
    max_tokens: 2048
    temperature: 0.3

  # Azure OpenAI 配置
  azure_openai:
    api_key: "${AZURE_OPENAI_API_KEY}"
    api_base: "${AZURE_OPENAI_ENDPOINT}"
    api_version: "${AZURE_OPENAI_API_VERSION}"
    deployment_name: "gpt-5.2"
    max_tokens: 16384
    temperature: 0.3

  # OpenAI 配置
  openai:
    api_key: "${OPENAI_API_KEY}"
    model: "gpt-4o"
    max_tokens: 2048
    temperature: 0.3

  # 自定义模型配置 (兼容 OpenAI API 格式)
  custom:
    api_key: "${CUSTOM_API_KEY}"
    api_base: "https://your-model-endpoint.com/v1"
    model: "your-model-name"
    max_tokens: 2048
    temperature: 0.3
    # 额外请求头
    extra_headers:
      X-Custom-Header: "value"

# 脱水配置
digest:
  # 高质量评分阈值 (终端只显示高于此分数的项目)
  high_quality_score_threshold: 80
  # 删除阈值 (低于此分数将被丢弃)
  remove_score_threshold: 50
  # 批量处理大小
  batch_size: 10
  # 摘要最大长度
  max_summary_length: 500
  # 最大爬取子页面数
  max_subpage_crawl: 30
  # 语义去重开关
  semantic_dedup_enabled: true
  # 语义去重后端: fastembed | openai | azure_openai
  semantic_backend: "fastembed"
  # fastembed 模型
  semantic_model: "BAAI/bge-small-en"
  # OpenAI embedding 模型
  semantic_embedding_model: "text-embedding-3-small"
  # Azure embedding 部署名 (为空则使用 ai.azure_openai.deployment_name)
  semantic_embedding_deployment: ""
  # 语义相似度阈值
  semantic_threshold: 0.95
  # 语义比对最大文本长度
  semantic_max_text_length: 1200

# 输出配置
output:
  # 报告文件名格式
  report_filename: "daily_report_{date}.md"
  # 是否生成 JSON 格式
  generate_json: true
  # 跨日去重缓存目录 (相对于 output_dir)
  dedup_history_dir: "dedup_cache"
  # 跨日去重缓存文件名 (JSONL)
  dedup_history_file: "dedup_history.jsonl"
  # 终端输出样式
  terminal:
    show_low_score: false
    color_theme: "monokai"

# 目标网站列表
sites:
  - name: "github_trending"
    enabled: true
    config_file: "sites/github_trending.yaml"

  - name: "hacker_news"
    enabled: true
    config_file: "sites/hacker_news.yaml"

  - name: "Lobsters"
    enabled: true
    config_file: "sites/lobsters.yaml"
